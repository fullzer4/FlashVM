---
title: Python API
---

## flashvm.prepare_image()

Idempotently imports the embedded OCI image into local containers-storage (prefers `skopeo copy`, falls back to buildah). Called automatically on first `run` when needed.

## flashvm.run(code: str, *, expect: list[str] | None = None, env: dict[str, str] | None = None, timeout: int | None = None) -> dict

Executes `code` in a microVM. Returns a dict with:

- `exit_code`: int
- `stdout`: str
- `stderr`: str
- `image_used`: str (image reference used to boot)
- `artifacts`: list[Artifact] â€” present when `expect` is provided

Where `Artifact` contains:
- `guest_path`: str (path inside VM)
- `host_path`: str (temporary path on host)
- `size_bytes`: int

Arguments:
- `expect`: glob(s) relative to `/work/out` in the guest to collect after run.
- `env`: environment variables for the guest process.
- `timeout`: optional timeout for the execution.

Raises exceptions on startup or transport errors (e.g., missing KVM).
